<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Giorgia Cecchinato, gcecchinato@worldbank.org">

<title>Accessing poverty and inequality data from the World Bank in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="R_part_1_files/libs/clipboard/clipboard.min.js"></script>
<script src="R_part_1_files/libs/quarto-html/quarto.js"></script>
<script src="R_part_1_files/libs/quarto-html/popper.min.js"></script>
<script src="R_part_1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="R_part_1_files/libs/quarto-html/anchor.min.js"></script>
<link href="R_part_1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="R_part_1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="R_part_1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="R_part_1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="R_part_1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="R_part_1_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="R_part_1_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="R_part_1_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="R_part_1_files/libs/datatables-binding-0.33/datatables.js"></script>
<script src="R_part_1_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="R_part_1_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="R_part_1_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="R_part_1_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="R_part_1_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="R_part_1_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="R_part_1_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="R_part_1_files/libs/typedarray-0.1/typedarray.min.js"></script>
<link href="R_part_1_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="R_part_1_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#the-poverty-and-inequality-platform-pip" id="toc-the-poverty-and-inequality-platform-pip" class="nav-link" data-scroll-target="#the-poverty-and-inequality-platform-pip"><span class="header-section-number">1.1</span> The Poverty and Inequality Platform (PIP)</a></li>
  <li><a href="#plan" id="toc-plan" class="nav-link" data-scroll-target="#plan"><span class="header-section-number">1.2</span> Plan</a></li>
  </ul></li>
  <li><a href="#accessing-pip-in-r" id="toc-accessing-pip-in-r" class="nav-link" data-scroll-target="#accessing-pip-in-r"><span class="header-section-number">2</span> Accessing PIP in R</a>
  <ul class="collapse">
  <li><a href="#install-pip" id="toc-install-pip" class="nav-link" data-scroll-target="#install-pip"><span class="header-section-number">2.1</span> Install PIP</a></li>
  <li><a href="#additional-packages" id="toc-additional-packages" class="nav-link" data-scroll-target="#additional-packages"><span class="header-section-number">2.2</span> Additional Packages</a></li>
  </ul></li>
  <li><a href="#country-level-estimates" id="toc-country-level-estimates" class="nav-link" data-scroll-target="#country-level-estimates"><span class="header-section-number">3</span> Country-level estimates</a>
  <ul class="collapse">
  <li><a href="#variables" id="toc-variables" class="nav-link" data-scroll-target="#variables"><span class="header-section-number">3.1</span> Variables</a></li>
  <li><a href="#auxiliary-data" id="toc-auxiliary-data" class="nav-link" data-scroll-target="#auxiliary-data"><span class="header-section-number">3.2</span> Auxiliary Data</a></li>
  <li><a href="#core-estimates" id="toc-core-estimates" class="nav-link" data-scroll-target="#core-estimates"><span class="header-section-number">3.3</span> Core estimates</a></li>
  </ul></li>
  <li><a href="#advanced-arguments" id="toc-advanced-arguments" class="nav-link" data-scroll-target="#advanced-arguments"><span class="header-section-number">4</span> Advanced arguments</a>
  <ul class="collapse">
  <li><a href="#fillgaps---extrapolated-and-interpolated-values" id="toc-fillgaps---extrapolated-and-interpolated-values" class="nav-link" data-scroll-target="#fillgaps---extrapolated-and-interpolated-values"><span class="header-section-number">4.1</span> Fillgaps - Extrapolated and interpolated values</a></li>
  <li><a href="#nowcast---projected-values" id="toc-nowcast---projected-values" class="nav-link" data-scroll-target="#nowcast---projected-values"><span class="header-section-number">4.2</span> Nowcast - Projected values</a></li>
  <li><a href="#popshare---population-share" id="toc-popshare---population-share" class="nav-link" data-scroll-target="#popshare---population-share"><span class="header-section-number">4.3</span> Popshare - population share</a></li>
  <li><a href="#comparability-income-vs-consumption" id="toc-comparability-income-vs-consumption" class="nav-link" data-scroll-target="#comparability-income-vs-consumption"><span class="header-section-number">4.4</span> Comparability (Income vs Consumption)</a></li>
  </ul></li>
  <li><a href="#global-and-regional-estimates" id="toc-global-and-regional-estimates" class="nav-link" data-scroll-target="#global-and-regional-estimates"><span class="header-section-number">5</span> Global and Regional estimates</a></li>
  <li><a href="#group-data-functions" id="toc-group-data-functions" class="nav-link" data-scroll-target="#group-data-functions"><span class="header-section-number">6</span> Group Data Functions</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Accessing poverty and inequality data from the World Bank in R</h1>
<p class="subtitle lead">Part 1</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Giorgia Cecchinato, gcecchinato@worldbank.org </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p><strong>Set-up</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pipr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<section id="the-poverty-and-inequality-platform-pip" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="the-poverty-and-inequality-platform-pip"><span class="header-section-number">1.1</span> The Poverty and Inequality Platform (PIP)</h2>
<ul>
<li><p>The World Bank helps low- and middle-income countries reduce poverty and produce data on poverty and inequality.</p></li>
<li><p>This gives the World Bank a unique access to poverty data.</p></li>
<li><p>Partly for that reason, the World Bank is the custodian of Sustainable Development Goals on ending poverty (SDG1) and reducing inequality (SDG10).</p></li>
<li><p>All this data is stored in the Poverty and Inequality Platform (PIP) at <a href="https://pip.worldbank.org">pip.worldbank.org</a>.</p></li>
<li><p><code>{pipr}</code> (<a href="https://github.com/worldbank/pipr">link to repo</a>) is a package which allows you to access the latest PIP data. It is basically an interface to the PIP API (<a href="https://pip.worldbank.org/api">link to API UI</a>).</p></li>
</ul>
</section>
<section id="plan" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="plan"><span class="header-section-number">1.2</span> Plan</h2>
<ul>
<li><p><strong>Part 1</strong>: overview of <code>{pipr}</code>, functions, arguments, output.</p>
<ul>
<li><p><strong>Part 1.1</strong>: core function: <code>get_stats().</code></p></li>
<li><p><strong>Part 1.2</strong>: advanced arguments: <code>fillgaps</code>, <code>nowcast</code>, <code>popshare</code>, <code>comparable_spell</code>.</p></li>
<li><p><strong>Part 1.3</strong>: regional data estimates: <code>get_wb()</code>.</p></li>
<li><p><strong>Part 1.4</strong>: group data function: <code>get_gd().</code></p></li>
</ul></li>
<li><p><strong>Part 2</strong>: data replication and exercises/visualizations.</p></li>
</ul>
</section>
</section>
<section id="accessing-pip-in-r" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Accessing PIP in R</h1>
<section id="install-pip" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="install-pip"><span class="header-section-number">2.1</span> Install PIP</h2>
<p><code>{pipr}</code> has not been released in CRAN yet, so to access it you need to use another package, <code>{devtools}</code>, so you can install it directly from the github repository:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>) <span class="co"># Install devtools</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools) <span class="co"># Load devtools</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"worldbank/pipr"</span>) <span class="co"># Install pipr</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pipr) <span class="co"># Load pipr</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="additional-packages" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="additional-packages"><span class="header-section-number">2.2</span> Additional Packages</h2>
<p>To run the code for this workshop you should also install some additional packages that help with data cleaning and visualization:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>, <span class="st">"purrr"</span>, <span class="st">"ggplot2"</span>) <span class="co"># Install dplyr (or tidyverse, if you have it)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="country-level-estimates" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Country-level estimates</h1>
<p>The core function of <code>pipr</code> is <code>get_stats()</code>, which retrieves <strong>country-level estimates</strong> of poverty and inequality metrics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_stats</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Pruning cache</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 44
  region_name        region_code country_name country_code  year reporting_level
  &lt;chr&gt;              &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;          
1 Sub-Saharan Africa SSA         Angola       AGO           2000 national       
2 Sub-Saharan Africa SSA         Angola       AGO           2008 national       
3 Sub-Saharan Africa SSA         Angola       AGO           2018 national       
4 Europe &amp; Central … ECA         Albania      ALB           1996 national       
5 Europe &amp; Central … ECA         Albania      ALB           2002 national       
# ℹ 38 more variables: survey_acronym &lt;chr&gt;, survey_coverage &lt;chr&gt;,
#   welfare_time &lt;dbl&gt;, welfare_type &lt;chr&gt;, survey_comparability &lt;dbl&gt;,
#   comparable_spell &lt;chr&gt;, poverty_line &lt;dbl&gt;, headcount &lt;dbl&gt;,
#   poverty_gap &lt;dbl&gt;, poverty_severity &lt;dbl&gt;, watts &lt;dbl&gt;, mean &lt;dbl&gt;,
#   median &lt;dbl&gt;, mld &lt;dbl&gt;, gini &lt;dbl&gt;, polarization &lt;dbl&gt;, decile1 &lt;dbl&gt;,
#   decile2 &lt;dbl&gt;, decile3 &lt;dbl&gt;, decile4 &lt;dbl&gt;, decile5 &lt;dbl&gt;, decile6 &lt;dbl&gt;,
#   decile7 &lt;dbl&gt;, decile8 &lt;dbl&gt;, decile9 &lt;dbl&gt;, decile10 &lt;dbl&gt;, cpi &lt;dbl&gt;, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nicer to look at:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_stats</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n=</span><span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-30712dcc5f313d54dc33" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-30712dcc5f313d54dc33">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5"],["Sub-Saharan Africa","Sub-Saharan Africa","Sub-Saharan Africa","Europe &amp; Central Asia","Europe &amp; Central Asia"],["SSA","SSA","SSA","ECA","ECA"],["Angola","Angola","Angola","Albania","Albania"],["AGO","AGO","AGO","ALB","ALB"],[2000,2008,2018,1996,2002],["national","national","national","national","national"],["HBS","IBEP-MICS","IDREA","EWS","LSMS"],["national","national","national","national","national"],[2000.21,2008.5,2018.17,1996,2002],["consumption","consumption","consumption","consumption","consumption"],[0,1,2,0,1],["2000","2008","2018","1996","2002 - 2012"],[2.15,2.15,2.15,2.15,2.15],[0.213605659674,0.145896882676,0.311220062314,0.005348460357,0.010926473904],[0.09090276933700001,0.040396380985,0.11919143728,0.0009821453680000001,0.001894348649],[0.052686230261,0.016466020402,0.062310130094,0.000304759078,0.000594229855],[0.147382485226,0.05335277132,0.179058968547,0.001203123916,0.002382839267],[7.388854270322,6.526025242888,5.482368049234,7.933157550406,8.108228791611999],[4.673318175877,4.703099810972,3.42050223773,6.972102629133,6.688141410712],[0.5094101121,0.311631502322,0.476333414611,0.119104326584,0.164811599639],[0.519447177794,0.427155149878,0.512639915479,0.270103419751,0.317389798335],[0.464338860671,0.391365249698,0.470981496535,0.241293272375,0.268981638919],[0.009912799103000001,0.020722704667,0.013348494052,0.038817883466,0.03523453383],[0.021986918901,0.033564171517,0.02428155828,0.052792297005,0.048484450621],[0.03341610857,0.043176167923,0.033329454749,0.063706566514,0.058520715358],[0.045094763699,0.053027305776,0.04343712694,0.07524025743899999,0.067376298306],[0.056465896952,0.065425990436,0.055829007432,0.083462238153,0.07640787331899999],[0.070481835704,0.07923758155000001,0.069808939273,0.092457305123,0.088384438922],[0.08817228475900001,0.096511887757,0.088692860198,0.107789612861,0.102324653414],[0.113397363605,0.122976103307,0.11567589176,0.126116176356,0.119868981708],[0.159391212433,0.162341588705,0.159380080037,0.152507706392,0.149999215591],[0.401680816274,0.323016498362,0.396216587278,0.207109956691,0.253398838931],[0.014172985611,0.302878429273,1.231041267654,0.399635230944,0.7016370015109999],[107.269989013672,107.269989013672,107.269989013672,50.357372283935,50.357372283935],[16509042.25000002,22099598,31457142.35000008,3168033,3051010],[1909.50206453685,3176.67216597867,2777.84304535304,1633.55200001885,2247.49808010881],[null,1201.3110922354,1495.34059467995,1716.33680111076,1685.20307823169],[false,false,false,false,false],["micro","micro","micro","micro","micro"],["survey","survey","survey","survey","survey"],[3.486659087938,3.501549905486,2.860251118865,4.636051314566,4.494070705356],[0.372371197736,0.353722243962,0.422226249912,0.195180297345,0.21285360265],[9.722334119325,6.925334115433,11.098809633168,3.999502912213,4.208419034209],[null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>region_name<\/th>\n      <th>region_code<\/th>\n      <th>country_name<\/th>\n      <th>country_code<\/th>\n      <th>year<\/th>\n      <th>reporting_level<\/th>\n      <th>survey_acronym<\/th>\n      <th>survey_coverage<\/th>\n      <th>welfare_time<\/th>\n      <th>welfare_type<\/th>\n      <th>survey_comparability<\/th>\n      <th>comparable_spell<\/th>\n      <th>poverty_line<\/th>\n      <th>headcount<\/th>\n      <th>poverty_gap<\/th>\n      <th>poverty_severity<\/th>\n      <th>watts<\/th>\n      <th>mean<\/th>\n      <th>median<\/th>\n      <th>mld<\/th>\n      <th>gini<\/th>\n      <th>polarization<\/th>\n      <th>decile1<\/th>\n      <th>decile2<\/th>\n      <th>decile3<\/th>\n      <th>decile4<\/th>\n      <th>decile5<\/th>\n      <th>decile6<\/th>\n      <th>decile7<\/th>\n      <th>decile8<\/th>\n      <th>decile9<\/th>\n      <th>decile10<\/th>\n      <th>cpi<\/th>\n      <th>ppp<\/th>\n      <th>pop<\/th>\n      <th>gdp<\/th>\n      <th>hfce<\/th>\n      <th>is_interpolated<\/th>\n      <th>distribution_type<\/th>\n      <th>estimation_type<\/th>\n      <th>spl<\/th>\n      <th>spr<\/th>\n      <th>pg<\/th>\n      <th>estimate_type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[5,9,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,41,42,43]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"region_name","targets":1},{"name":"region_code","targets":2},{"name":"country_name","targets":3},{"name":"country_code","targets":4},{"name":"year","targets":5},{"name":"reporting_level","targets":6},{"name":"survey_acronym","targets":7},{"name":"survey_coverage","targets":8},{"name":"welfare_time","targets":9},{"name":"welfare_type","targets":10},{"name":"survey_comparability","targets":11},{"name":"comparable_spell","targets":12},{"name":"poverty_line","targets":13},{"name":"headcount","targets":14},{"name":"poverty_gap","targets":15},{"name":"poverty_severity","targets":16},{"name":"watts","targets":17},{"name":"mean","targets":18},{"name":"median","targets":19},{"name":"mld","targets":20},{"name":"gini","targets":21},{"name":"polarization","targets":22},{"name":"decile1","targets":23},{"name":"decile2","targets":24},{"name":"decile3","targets":25},{"name":"decile4","targets":26},{"name":"decile5","targets":27},{"name":"decile6","targets":28},{"name":"decile7","targets":29},{"name":"decile8","targets":30},{"name":"decile9","targets":31},{"name":"decile10","targets":32},{"name":"cpi","targets":33},{"name":"ppp","targets":34},{"name":"pop","targets":35},{"name":"gdp","targets":36},{"name":"hfce","targets":37},{"name":"is_interpolated","targets":38},{"name":"distribution_type","targets":39},{"name":"estimation_type","targets":40},{"name":"spl","targets":41},{"name":"spr","targets":42},{"name":"pg","targets":43},{"name":"estimate_type","targets":44}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li>Each row identfies a unique combination of
<ul>
<li>country_code: ISO 3 code.</li>
<li>year: <code>all</code> for all years, or numeric.</li>
<li>reporting_level: national, urban, rural.</li>
<li>welfare_type: income, consumption.</li>
</ul></li>
</ul>
<section id="variables" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="variables"><span class="header-section-number">3.1</span> Variables</h2>
<p>There are a number of available variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(<span class="fu">get_stats</span>()) <span class="co"># variables available</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "region_name"          "region_code"          "country_name"        
 [4] "country_code"         "year"                 "reporting_level"     
 [7] "survey_acronym"       "survey_coverage"      "welfare_time"        
[10] "welfare_type"         "survey_comparability" "comparable_spell"    
[13] "poverty_line"         "headcount"            "poverty_gap"         
[16] "poverty_severity"     "watts"                "mean"                
[19] "median"               "mld"                  "gini"                
[22] "polarization"         "decile1"              "decile2"             
[25] "decile3"              "decile4"              "decile5"             
[28] "decile6"              "decile7"              "decile8"             
[31] "decile9"              "decile10"             "cpi"                 
[34] "ppp"                  "pop"                  "gdp"                 
[37] "hfce"                 "is_interpolated"      "distribution_type"   
[40] "estimation_type"      "spl"                  "spr"                 
[43] "pg"                   "estimate_type"       </code></pre>
</div>
</div>
<p>And you can access info about those variables here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_aux</span>(<span class="st">"dictionary"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  variable     definition                                                       
  &lt;chr&gt;        &lt;chr&gt;                                                            
1 region_name  World Bank region name                                           
2 region_code  Three-letter World Bank abbreviation of world regions            
3 year         Year                                                             
4 country_name World Bank country name                                          
5 country_code Three-letter ISO (alpha-3) country code system for international…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get_dictionary() # equivalent</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="auxiliary-data" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="auxiliary-data"><span class="header-section-number">3.2</span> Auxiliary Data</h2>
<p><code>get_aux()</code> allows you to access to alist of auxiliary data and tables.</p>
<p>For instance, you can access GDP data used in the calculations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_aux</span>(<span class="st">"gdp"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(value <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> <span class="co"># First line is a row of NAs...</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  country_code data_level year   value
  &lt;chr&gt;        &lt;chr&gt;      &lt;fct&gt;  &lt;dbl&gt;
1 ABW          national   1986  16112.
2 ABW          national   1987  18732.
3 ABW          national   1988  22266.
4 ABW          national   1989  24865.
5 ABW          national   1990  25411.</code></pre>
</div>
</div>
<p>Or access a series of info about how the data is calculated. For example, <code>incgrp_coverage</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_aux</span>(<span class="st">"incgrp_coverage"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
   year incgroup_historical coverage
  &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt;
1  1981 LIC/LMIC                65.3
2  1982 LIC/LMIC                69.7
3  1983 LIC/LMIC                73.0
4  1984 LIC/LMIC                77.6
5  1985 LIC/LMIC                78.0</code></pre>
</div>
</div>
<p>Which returns a table of survey coverage for low and lower-middle income countries for any given year. This table shows how the coverage rule is applied: under this requirement, global poverty estimates are reported only if data are representative of at least 50 percent of the population in low-income and lower-middle-income countries.</p>
</section>
<section id="core-estimates" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="core-estimates"><span class="header-section-number">3.3</span> Core estimates</h2>
<p>We can have a closer look at the core estimates for a Country, e.g.&nbsp;Nigeria:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_stats</span>(<span class="at">country =</span> <span class="st">"NGA"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(country_code, year, poverty_line, headcount, mean, gini))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
  country_code  year poverty_line headcount  mean  gini
  &lt;chr&gt;        &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 NGA           1985         2.15     0.478  2.90 0.387
2 NGA           1992         2.15     0.524  2.86 0.449
3 NGA           1996         2.15     0.584  2.92 0.519
4 NGA           2003         2.15     0.479  2.92 0.401
5 NGA           2010         2.15     0.349  3.50 0.357
6 NGA           2012         2.15     0.338  3.55 0.355
7 NGA           2015         2.15     0.323  3.68 0.359
8 NGA           2018         2.15     0.309  3.66 0.351</code></pre>
</div>
</div>
<p>Note that the default poverty line is $2.15 (per capita, per day), in 2017 PPP-adjusted dollars, and the mean is expressed in the same way.</p>
<p>Obviously, you can request a different poverty line:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_stats</span>(<span class="at">country =</span> <span class="st">"NGA"</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">povline =</span> <span class="fl">1.9</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(country_code, year, poverty_line, headcount))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  country_code  year poverty_line headcount
  &lt;chr&gt;        &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;
1 NGA           1985          1.9     0.413
2 NGA           1992          1.9     0.471
3 NGA           1996          1.9     0.528
4 NGA           2003          1.9     0.413
5 NGA           2010          1.9     0.278
6 NGA           2012          1.9     0.268
7 NGA           2015          1.9     0.255
8 NGA           2018          1.9     0.244</code></pre>
</div>
</div>
<p>You can loop the request to get multiple poverty lines, this is just one way to do it, using <code>map_dfr()</code> from the <code>{purrr}</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>povlines <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.9</span>, <span class="fl">2.15</span>, <span class="fl">3.2</span>, <span class="fl">5.5</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>NGA_estimates <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.x =</span> povlines, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span><span class="fu">get_stats</span>(<span class="at">country =</span> <span class="st">"NGA"</span>, <span class="at">povline =</span> .x)) <span class="sc">|&gt;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(country_code, year, poverty_line, headcount, mean))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>NGA_estimates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 5
   country_code  year poverty_line headcount  mean
   &lt;chr&gt;        &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 NGA           1985         1.9      0.413  2.90
 2 NGA           1992         1.9      0.471  2.86
 3 NGA           1996         1.9      0.528  2.92
 4 NGA           2003         1.9      0.413  2.92
 5 NGA           2010         1.9      0.278  3.50
 6 NGA           2012         1.9      0.268  3.55
 7 NGA           2015         1.9      0.255  3.68
 8 NGA           2018         1.9      0.244  3.66
 9 NGA           1985         2.15     0.478  2.90
10 NGA           1992         2.15     0.524  2.86
# ℹ 22 more rows</code></pre>
</div>
</div>
<p>So you can actually start working with these data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("plotly")</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly) <span class="co"># You don't really need to install this, but it's cool..</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> NGA_estimates <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> headcount, <span class="at">color =</span> <span class="fu">factor</span>(poverty_line))) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Headcount Ratio by Poverty Line and Year, NGA"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Poverty Line"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Headcount Ratio"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-faf7428df0b6b6d59191" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-faf7428df0b6b6d59191">{"x":{"data":[{"x":[1985,1992,1996,2003,2010,2012,2015,2018],"y":[0.41331000000000001,0.47115221762199999,0.52753582304299995,0.41336158352800001,0.27764597870300001,0.268234408014,0.25477331162200001,0.24420396490900001],"text":["year: 1985<br />headcount: 0.4133100<br />factor(poverty_line): 1.9","year: 1992<br />headcount: 0.4711522<br />factor(poverty_line): 1.9","year: 1996<br />headcount: 0.5275358<br />factor(poverty_line): 1.9","year: 2003<br />headcount: 0.4133616<br />factor(poverty_line): 1.9","year: 2010<br />headcount: 0.2776460<br />factor(poverty_line): 1.9","year: 2012<br />headcount: 0.2682344<br />factor(poverty_line): 1.9","year: 2015<br />headcount: 0.2547733<br />factor(poverty_line): 1.9","year: 2018<br />headcount: 0.2442040<br />factor(poverty_line): 1.9"],"type":"scatter","mode":"lines+markers","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"1.9","legendgroup":"1.9","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"frame":null},{"x":[1985,1992,1996,2003,2010,2012,2015,2018],"y":[0.47821999999999998,0.52353875088199997,0.58419514791500005,0.47878924634499997,0.34885328105500002,0.338289211486,0.32256629699,0.30863298351099999],"text":["year: 1985<br />headcount: 0.4782200<br />factor(poverty_line): 2.15","year: 1992<br />headcount: 0.5235388<br />factor(poverty_line): 2.15","year: 1996<br />headcount: 0.5841951<br />factor(poverty_line): 2.15","year: 2003<br />headcount: 0.4787892<br />factor(poverty_line): 2.15","year: 2010<br />headcount: 0.3488533<br />factor(poverty_line): 2.15","year: 2012<br />headcount: 0.3382892<br />factor(poverty_line): 2.15","year: 2015<br />headcount: 0.3225663<br />factor(poverty_line): 2.15","year: 2018<br />headcount: 0.3086330<br />factor(poverty_line): 2.15"],"type":"scatter","mode":"lines+markers","line":{"width":1.8897637795275593,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"2.15","legendgroup":"2.15","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(124,174,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(124,174,0,1)"}},"frame":null},{"x":[1985,1992,1996,2003,2010,2012,2015,2018],"y":[0.68566999999900002,0.68956662208700004,0.74016261300399999,0.69308641637400004,0.58773263988799995,0.57732020522000005,0.55841801821000003,0.55068589667000001],"text":["year: 1985<br />headcount: 0.6856700<br />factor(poverty_line): 3.2","year: 1992<br />headcount: 0.6895666<br />factor(poverty_line): 3.2","year: 1996<br />headcount: 0.7401626<br />factor(poverty_line): 3.2","year: 2003<br />headcount: 0.6930864<br />factor(poverty_line): 3.2","year: 2010<br />headcount: 0.5877326<br />factor(poverty_line): 3.2","year: 2012<br />headcount: 0.5773202<br />factor(poverty_line): 3.2","year: 2015<br />headcount: 0.5584180<br />factor(poverty_line): 3.2","year: 2018<br />headcount: 0.5506859<br />factor(poverty_line): 3.2"],"type":"scatter","mode":"lines+markers","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"3.2","legendgroup":"3.2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"frame":null},{"x":[1985,1992,1996,2003,2010,2012,2015,2018],"y":[0.88710999999899998,0.87447746022299999,0.88813505902400003,0.89487789130899997,0.84290320470400004,0.83817605494699998,0.82414580935799997,0.83881711247699997],"text":["year: 1985<br />headcount: 0.8871100<br />factor(poverty_line): 5.5","year: 1992<br />headcount: 0.8744775<br />factor(poverty_line): 5.5","year: 1996<br />headcount: 0.8881351<br />factor(poverty_line): 5.5","year: 2003<br />headcount: 0.8948779<br />factor(poverty_line): 5.5","year: 2010<br />headcount: 0.8429032<br />factor(poverty_line): 5.5","year: 2012<br />headcount: 0.8381761<br />factor(poverty_line): 5.5","year: 2015<br />headcount: 0.8241458<br />factor(poverty_line): 5.5","year: 2018<br />headcount: 0.8388171<br />factor(poverty_line): 5.5"],"type":"scatter","mode":"lines+markers","line":{"width":1.8897637795275593,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"5.5","legendgroup":"5.5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(199,124,255,1)"}},"frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826498,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Headcount Ratio by Poverty Line and Year, NGA","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1983.3499999999999,2019.6500000000001],"tickmode":"array","ticktext":["1990","2000","2010"],"tickvals":[1990,2000,2010],"categoryorder":"array","categoryarray":["1990","2000","2010"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Poverty Line","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.21167026858900001,0.927411587629],"tickmode":"array","ticktext":["0.4","0.6","0.8"],"tickvals":[0.40000000000000002,0.60000000000000009,0.80000000000000004],"categoryorder":"array","categoryarray":["0.4","0.6","0.8"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Headcount Ratio","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5b3747318ff":{"x":{},"y":{},"colour":{},"type":"scatter"},"5b3306e4913":{"x":{},"y":{},"colour":{}}},"cur_data":"5b3747318ff","visdat":{"5b3747318ff":["function (y) ","x"],"5b3306e4913":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>You can also get multiple countries for a given year:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_stats</span>(<span class="at">country =</span> <span class="fu">c</span>(<span class="st">"ITA"</span>,<span class="st">"NGA"</span>), <span class="at">year=</span><span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(country_code, year, poverty_line, headcount, mean, gini))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  country_code  year poverty_line headcount  mean  gini
  &lt;chr&gt;        &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 ITA           2018         2.15    0.0146 48.1  0.352
2 NGA           2018         2.15    0.309   3.66 0.351</code></pre>
</div>
</div>
</section>
</section>
<section id="advanced-arguments" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Advanced arguments</h1>
<section id="fillgaps---extrapolated-and-interpolated-values" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="fillgaps---extrapolated-and-interpolated-values"><span class="header-section-number">4.1</span> Fillgaps - Extrapolated and interpolated values</h2>
<p>Some countries do not have data for all years, and <code>pipr</code> defaults to showing only the estimates generated using the actual survey data available.</p>
<p>However, we also calculated values for years where there is no data, using a combination of extrapolation and interpolation (we will see the methodology behind that in part 2).</p>
<p>You can use the <code>fillgaps</code> argument to get extrapolated and interpolated values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Default</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_stats</span>(<span class="at">country =</span> <span class="st">"ALB"</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">&gt;</span><span class="dv">2010</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(country_code, year, poverty_line, headcount))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 4
   country_code  year poverty_line headcount
   &lt;chr&gt;        &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;
 1 ALB           2012         2.15  0.00621 
 2 ALB           2014         2.15  0.0102  
 3 ALB           2015         2.15  0.000961
 4 ALB           2016         2.15  0.00139 
 5 ALB           2016         2.15  0.0580  
 6 ALB           2017         2.15  0.00393 
 7 ALB           2017         2.15  0.0526  
 8 ALB           2018         2.15  0.000481
 9 ALB           2018         2.15  0.0389  
10 ALB           2019         2.15  0       
11 ALB           2020         2.15  0.000213</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With estimates:</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>ALB_estimates <span class="ot">&lt;-</span> <span class="fu">get_stats</span>(<span class="at">country =</span> <span class="st">"ALB"</span>, <span class="at">fill_gaps =</span> <span class="cn">TRUE</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">&gt;</span><span class="dv">2005</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(country_code, year, poverty_line, headcount, estimation_type, estimate_type))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>ALB_estimates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17 × 6
   country_code  year poverty_line headcount estimation_type estimate_type
   &lt;chr&gt;        &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;        
 1 ALB           2006         2.15  0.00400  interpolation   projection   
 2 ALB           2007         2.15  0.00287  interpolation   projection   
 3 ALB           2008         2.15  0.00200  survey          actual       
 4 ALB           2009         2.15  0.00329  interpolation   projection   
 5 ALB           2010         2.15  0.00451  interpolation   projection   
 6 ALB           2011         2.15  0.00515  interpolation   projection   
 7 ALB           2012         2.15  0.00621  survey          actual       
 8 ALB           2013         2.15  0.00927  interpolation   projection   
 9 ALB           2014         2.15  0.0102   survey          actual       
10 ALB           2015         2.15  0.000961 survey          actual       
11 ALB           2016         2.15  0.00139  survey          actual       
12 ALB           2017         2.15  0.00393  survey          actual       
13 ALB           2018         2.15  0.000481 survey          actual       
14 ALB           2019         2.15  0        survey          actual       
15 ALB           2020         2.15  0.000213 survey          actual       
16 ALB           2021         2.15  0.000213 extrapolation   projection   
17 ALB           2022         2.15  0        extrapolation   projection   </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ALB_estimates, </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> headcount, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> estimation_type, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> estimate_type)) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> poverty_line)) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Poverty Headcount by Estimation and Estimate Type, ALB"</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Headcount Ratio"</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Estimation Type"</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Estimate Type"</span>) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_part_1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nowcast---projected-values" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="nowcast---projected-values"><span class="header-section-number">4.2</span> Nowcast - Projected values</h2>
<p>The <code>nowcast</code> argument allows you to get projected values for the most recent years. Note that <code>nowcast = TRUE</code> implies <code>fillgaps = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With estimates:</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>ALB_estimates_now <span class="ot">&lt;-</span> <span class="fu">get_stats</span>(<span class="at">country =</span> <span class="st">"ALB"</span>, <span class="at">nowcast =</span> <span class="cn">TRUE</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">&gt;</span><span class="dv">2005</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(country_code, year, poverty_line, headcount, estimation_type, estimate_type))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ALB_estimates_now, </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> headcount, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> estimation_type, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> estimate_type)) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> poverty_line)) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Poverty Headcount by Estimation and Estimate Type, ALB"</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Headcount Ratio"</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Estimation Type"</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Estimate Type"</span>) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_part_1_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="popshare---population-share" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="popshare---population-share"><span class="header-section-number">4.3</span> Popshare - population share</h2>
<p>Instead of supplying a poverty line, you could also set the argument <code>popshare</code>, which returns a poverty line for a given population share (headcount).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_stats</span>(<span class="at">country =</span> <span class="st">"ALB"</span>, <span class="at">popshare =</span> <span class="fl">0.10</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(country_code, year, poverty_line, headcount))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 4
   country_code  year poverty_line headcount
   &lt;chr&gt;        &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;
 1 ALB           1996         3.69    0.0997
 2 ALB           2002         3.50    0.0990
 3 ALB           2005         3.98    0.0999
 4 ALB           2008         4.60    0.0998
 5 ALB           2012         4.41    0.0995
 6 ALB           2014         3.67    0.0992
 7 ALB           2015         4.87    0.0997
 8 ALB           2016         4.70    0.0999
 9 ALB           2016         2.77    0.0974
10 ALB           2017         4.90    0.0997
11 ALB           2017         3.00    0.0998
12 ALB           2018         5.48    0.0998
13 ALB           2018         3.43    0.0999
14 ALB           2019         6.02    0.0998
15 ALB           2020         6.13    0.0997</code></pre>
</div>
</div>
</section>
<section id="comparability-income-vs-consumption" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="comparability-income-vs-consumption"><span class="header-section-number">4.4</span> Comparability (Income vs Consumption)</h2>
<p>Metrics are calculated using either income or consumption data. The <code>comparable_spell</code> variable indicates whether the data is comparable across years within a country. <code>welfare_type</code> helps you identify whether the data is based on income or consumption.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>CHN_estimates <span class="ot">&lt;-</span> <span class="fu">get_stats</span>(<span class="at">country=</span><span class="st">"CHN"</span>) <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(reporting_level<span class="sc">==</span><span class="st">"national"</span>) <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(year, headcount, comparable_spell, welfare_type)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>CHN_estimates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22 × 4
    year headcount comparable_spell welfare_type
   &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;       
 1  1981     0.918 1981 - 1987      income      
 2  1984     0.812 1981 - 1987      income      
 3  1987     0.674 1981 - 1987      income      
 4  1990     0.720 1990 - 2012      consumption 
 5  1993     0.656 1990 - 2012      consumption 
 6  1996     0.482 1990 - 2012      consumption 
 7  1999     0.461 1990 - 2012      consumption 
 8  2002     0.369 1990 - 2012      consumption 
 9  2005     0.223 1990 - 2012      consumption 
10  2008     0.173 1990 - 2012      consumption 
# ℹ 12 more rows</code></pre>
</div>
</div>
<p>Note that if you add <code>fill_gaps</code> or <code>nowcast</code>, the <code>comparable_spell</code> variable will be set to <code>NA</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_stats</span>(<span class="at">country=</span><span class="st">"CHN"</span>, <span class="at">nowcast =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(reporting_level<span class="sc">==</span><span class="st">"national"</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(country_code, year, headcount, comparable_spell, welfare_type, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>           estimation_type, estimate_type) <span class="sc">|&gt;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="dv">1987</span><span class="sc">:</span><span class="dv">1995</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 7
  country_code  year headcount comparable_spell welfare_type estimation_type
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;        &lt;chr&gt;          
1 CHN           1987     0.674 &lt;NA&gt;             income       survey         
2 CHN           1988     0.607 &lt;NA&gt;             income       extrapolation  
3 CHN           1989     0.732 &lt;NA&gt;             consumption  extrapolation  
4 CHN           1990     0.720 &lt;NA&gt;             consumption  survey         
5 CHN           1991     0.703 &lt;NA&gt;             consumption  interpolation  
6 CHN           1992     0.679 &lt;NA&gt;             consumption  interpolation  
7 CHN           1993     0.656 &lt;NA&gt;             consumption  survey         
8 CHN           1994     0.586 &lt;NA&gt;             consumption  interpolation  
9 CHN           1995     0.528 &lt;NA&gt;             consumption  interpolation  
# ℹ 1 more variable: estimate_type &lt;chr&gt;</code></pre>
</div>
</div>
<p>So do your hormework (check <code>welfare_type</code>) before using the data!</p>
</section>
</section>
<section id="global-and-regional-estimates" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Global and Regional estimates</h1>
<p>The other core function is <code>get_wb()</code>. This function retrieves global and regional estimates. Each row identifies a region-year combination.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_wb</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 14
  region_name               region_code  year poverty_line headcount poverty_gap
  &lt;chr&gt;                     &lt;chr&gt;       &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 Eastern and Southern Afr… AFE          1981         2.15     0.520       0.221
2 Eastern and Southern Afr… AFE          1982         2.15     0.524       0.225
3 Eastern and Southern Afr… AFE          1983         2.15     0.529       0.229
4 Eastern and Southern Afr… AFE          1984         2.15     0.539       0.235
5 Eastern and Southern Afr… AFE          1985         2.15     0.547       0.240
# ℹ 8 more variables: poverty_severity &lt;dbl&gt;, watts &lt;dbl&gt;, mean &lt;dbl&gt;,
#   spr &lt;dbl&gt;, pg &lt;dbl&gt;, estimate_type &lt;chr&gt;, pop &lt;dbl&gt;, pop_in_poverty &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Which regions?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_aux</span>(<span class="st">"regions"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  region                      region_code grouping_type
  &lt;chr&gt;                       &lt;chr&gt;       &lt;chr&gt;        
1 Eastern and Southern Africa AFE         africa_split 
2 Western and Central Africa  AFW         africa_split 
3 East Asia &amp; Pacific         EAP         region       
4 Europe &amp; Central Asia       ECA         region       
5 Latin America &amp; Caribbean   LAC         region       </code></pre>
</div>
</div>
<p>We will learn how to calculate regional level estimates in Part 2.</p>
<p>You can also get global estimates (<code>region_code = "WLD</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">get_wb</span>() <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1990</span>, region_code <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"WLD"</span>,<span class="st">"EAP"</span>,<span class="st">"SSA"</span>))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(world, <span class="fu">aes</span>(<span class="at">x =</span> year,<span class="at">y =</span> <span class="dv">100</span><span class="sc">*</span>headcount,<span class="at">color=</span>region_code)) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Global poverty, 1990-2022"</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Poverty rate (%)"</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_part_1_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="group-data-functions" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Group Data Functions</h1>
<p>For some countries or years, we only have access to group data. An example of group data is available for you in <code>{pipr}</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>pipr<span class="sc">::</span>datt_rural <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-25bdb39442da3cdcd8a7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-25bdb39442da3cdcd8a7">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13"],["0 – 30","30 – 40","40 – 50","50 – 60","60 – 75","75 – 85","85 – 100","100 – 125","125 – 150","150 – 200","200 – 250","250 – 300","300 &amp; above"],[24.4,35.8,45.36,55.1,64.92,77.08,91.75,110.64,134.9,167.76,215.48,261.66,384.97],[0.92,2.47,5.11,7.9,9.69,15.24,13.64,16.99,10,9.779999999999999,3.96,1.81,2.49],[0.0092,0.0339,0.08500000000000001,0.164,0.2609,0.4133,0.5497,0.7195999999999999,0.8195999999999999,0.9174,0.9570000000000001,0.9751000000000001,1],[0.002042929048795653,0.01009032944387782,0.03118484597313321,0.07079935887629875,0.1280496788506981,0.2349557337008858,0.3488484821281977,0.5199213657970849,0.6426900439343506,0.7920048595646907,0.8696613542047731,0.9127627705885599,1],["rural","rural","rural","rural","rural","rural","rural","rural","rural","rural","rural","rural","rural"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>monthly_pc_exp<\/th>\n      <th>mean_monthly_pc_exp<\/th>\n      <th>percentage_of_persons<\/th>\n      <th>p<\/th>\n      <th>L<\/th>\n      <th>area<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"monthly_pc_exp","targets":1},{"name":"mean_monthly_pc_exp","targets":2},{"name":"percentage_of_persons","targets":3},{"name":"p","targets":4},{"name":"L","targets":5},{"name":"area","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>These data are from rural India in 1983 and are used in one of the core methodology paper (Datt, 1998). Data are grouped monthly per capita consumption expenditure bins.</p>
<p>For this type of data, the function, <code>get_gd()</code> allows you to retrieve poverty metrics and/or the exact parameters used to calculate them.</p>
<p>For the metrics, use the argument <code>estimate = "stats"</code> and provide the requested mean and poverty line:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>datt_mean <span class="ot">&lt;-</span> <span class="fl">109.9</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>datt_povline <span class="ot">&lt;-</span> <span class="dv">89</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_gd</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cum_welfare =</span> datt_rural<span class="sc">$</span>L,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cum_population =</span> datt_rural<span class="sc">$</span>p,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">requested_mean =</span> datt_mean,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">povline =</span> datt_povline,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> <span class="st">"stats"</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Found url in cache "c801084871ca35b599a8b76acf765e39"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cached value is stale; checking for updates</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving response to cache "c801084871ca35b599a8b76acf765e39"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 20
  poverty_line  mean median headcount poverty_gap poverty_severity watts  gini
         &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1           89  110.   94.3     0.451       0.125           0.0476 0.165 0.289
# ℹ 12 more variables: mld &lt;dbl&gt;, polarization &lt;dbl&gt;, decile1 &lt;dbl&gt;,
#   decile2 &lt;dbl&gt;, decile3 &lt;dbl&gt;, decile4 &lt;dbl&gt;, decile5 &lt;dbl&gt;, decile6 &lt;dbl&gt;,
#   decile7 &lt;dbl&gt;, decile8 &lt;dbl&gt;, decile9 &lt;dbl&gt;, decile10 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>For the Lorenz curve points, use the argument <code>estimate = "lorenz"</code> and the number of bins/data points:</p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_gd</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cum_welfare =</span> datt_rural<span class="sc">$</span>L,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cum_population =</span> datt_rural<span class="sc">$</span>p,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> <span class="st">"lorenz"</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_bins =</span> <span class="dv">10</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Found url in cache "02542c98b50a7443cbf39ec8fba38d09"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cached value is stale; checking for updates</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving response to cache "02542c98b50a7443cbf39ec8fba38d09"</code></pre>
</div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d16c5d199e9e289915c8" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d16c5d199e9e289915c8">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],[-0,0.04425185750417665,0.1035519849971201,0.1753883405849425,0.2588904878665956,0.3543262502740601,0.46324636865845,0.5895080832912001,0.7436018695228426,0.9999999999999996],[0,0.1111111111111111,0.2222222222222222,0.3333333333333333,0.4444444444444444,0.5555555555555556,0.6666666666666666,0.7777777777777777,0.8888888888888888,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>welfare<\/th>\n      <th>weight<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"welfare","targets":1},{"name":"weight","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>lorenz_points_lq <span class="ot">&lt;-</span> <span class="fu">get_gd</span>(datt_rural<span class="sc">$</span>L, datt_rural<span class="sc">$</span>p, <span class="at">estimate =</span> <span class="st">"lorenz"</span>, <span class="at">lorenz =</span> <span class="st">"lq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Found url in cache "ee4673f56b68da0f8a64f0c90975922c"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cached value is stale; checking for updates</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving response to cache "ee4673f56b68da0f8a64f0c90975922c"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>lorenz_points_lq_10 <span class="ot">&lt;-</span> <span class="fu">get_gd</span>(datt_rural<span class="sc">$</span>L, datt_rural<span class="sc">$</span>p, <span class="at">estimate =</span> <span class="st">"lorenz"</span>, <span class="at">lorenz =</span> <span class="st">"lq"</span>, <span class="at">n_bins =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Found url in cache "5d7d5440168d8a849956e2f4ea94883b"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cached value is stale; checking for updates</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving response to cache "5d7d5440168d8a849956e2f4ea94883b"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data =</span> lorenz_points_lq_10, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> welfare), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"darkorange"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> datt_rural, <span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> L), <span class="at">color =</span> <span class="st">"darkorange"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> lorenz_points_lq, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> welfare), <span class="at">color =</span> <span class="st">"darkorange"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Lorenz Curve for Rural India, 1983"</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cumulative Share of Population"</span>,</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative Share of Welfare"</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_part_1_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For the exact parameters used to calculate the poverty metrics, use the argument <code>estimate = "params"</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_gd</span>(</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cum_welfare =</span> datt_rural<span class="sc">$</span>L,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cum_population =</span> datt_rural<span class="sc">$</span>p,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> <span class="st">"params"</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Found url in cache "6d257e8577c2128dee84a591e6d5f9ee"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cached value is stale; checking for updates</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving response to cache "6d257e8577c2128dee84a591e6d5f9ee"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 16
  lorenz     A      B     C  ymean     sst     sse    r2     mse    se_A    se_B
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 lq     0.888 -1.45  0.202  0.122  0.0846 3.51e-6  1.00 3.90e-7 0.00676 0.0193 
2 lb     0.561  0.930 0.580 -2.50  11.0    3.25e-3  1.00 3.61e-4 0.0150  0.00554
# ℹ 5 more variables: se_C &lt;dbl&gt;, validity &lt;lgl&gt;, normality &lt;lgl&gt;,
#   selected_for_dist &lt;chr&gt;, selected_for_pov &lt;chr&gt;</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>